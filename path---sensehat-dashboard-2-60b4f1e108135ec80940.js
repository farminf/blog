webpackJsonp([60135101834148],{343:function(A,e){A.exports={data:{markdownRemark:{html:'<p>In the last post, I prepared my API part and make it ready for accepting my HTTP calls, so in this one I write a simple python script to read the values from Sense HAT and POST it to my API to save it in MongoDB.</p>\n<p>I want to read temperature, humidity and pressure from Sense HAT and I want to read it every 2 minutes. I know this is a small interval of time for these kind of sensors but I do it just for fun ðŸ™‚</p>\n<p>In one of my previous posts I did the temperature part to have the best value since <code>sense.get_temperature()</code> doesnâ€™t really give a real temperature value. Then, I can read humidity and pressure easily:</p>\n<pre><code class="language-python">humidity = sense.get_humidity()\n\npressure = sense.get_pressure()\n</code></pre>\n<p>Afterward, I need to implement my POST part. as you see in my last post I design my API in the way that I need to POST "/sensehat" a string like <code>{sensor : "$name_of_sensor" , value: "$value" , timestamp:"$time_in_milliseconds_unix_format"}</code>:</p>\n<pre><code class="language-python">import urllib2\n\nreq = urllib2.Request("http://localhost:3000/sensehat")\nreq.add_header(â€˜Content-Typeâ€™, â€˜application/jsonâ€™)\n\nresponse = urllib2.urlopen(req, json.dumps(result_json))\n</code></pre>\n<p>At the end my script would be something like this:</p>\n<pre><code class="language-python">At the end my script would be something like this:\n\nimport urllib2\nimport os\nimport time\nfrom sense_hat import SenseHat\nimport json\nfrom datetime import datetime\n\n# get CPU temperature\ndef get_cpu_temp():\nres = os.popen("vcgencmd measure_temp").readline()\nt = float(res.replace("temp=","").replace("â€˜C\\n",""))\nreturn(t)\n\n# use moving average to smooth readings\ndef get_smooth(x):\nif not hasattr(get_smooth, "t"):\nget_smooth.t = [x,x,x]\nget_smooth.t[2] = get_smooth.t[1]\nget_smooth.t[1] = get_smooth.t[0]\nget_smooth.t[0] = x\nxs = (get_smooth.t[0]+get_smooth.t[1]+get_smooth.t[2])/3\nreturn(xs)\n\nsense = SenseHat()\nsense.clear()\n\nwhile True:\nreq = urllib2.Request("http://localhost:3000/sensehat")\nreq.add_header(â€˜Content-Typeâ€™, â€˜application/jsonâ€™)\n#Temperature\nt1 = sense.get_temperature_from_humidity()\nt2 = sense.get_temperature_from_pressure()\nt_cpu = get_cpu_temp()\nt = (t1+t2)/2\nt_corr = t â€“ ((t_cpu-t)/1.5)\nt_corr = get_smooth(t_corr)\ntimestamp = int(time.time()*1000)\nresult_json_temperature = {\n    "sensor":"temperature" ,\n    "value" : t_corr ,\n    "timestamp" : timestamp }\nresponse = urllib2.urlopen(req, json.dumps(result_json_temperature))\nprint (response)\n\n#Humidity\nreq = urllib2.Request("http://localhost:3000/sensehat")\nreq.add_header(â€˜Content-Typeâ€™, â€˜application/jsonâ€™)\nhumidity = sense.get_humidity()\ntimestamp = int(time.time()*1000)\nresult_json_humidity = {\n    "sensor":"humidity",\n    "value" : humidity ,\n    "timestamp" : timestamp }\nresponse = urllib2.urlopen(req, json.dumps(result_json_humidity))\nprint (response)\n\n#Pressure\nreq = urllib2.Request("http://localhost:3000/sensehat")\nreq.add_header(â€˜Content-Typeâ€™, â€˜application/jsonâ€™)\npressure = sense.get_pressure()\ntimestamp = int(time.time()*1000)\nresult_json_pressure = {\n    "sensor": "pressure" ,\n    "value": pressure ,\n    "timestamp": timestamp }\nresponse = urllib2.urlopen(req, json.dumps(result_json_pressure))\nprint (response)\n\n# Sleep for 2 minutes\ntime.sleep(120)\n</code></pre>\n<p>I started my API app, with "npm start" in a <a href="https://www.mankier.com/1/screenie">Screenie</a> session and then I run my Python code in another Screenie session and leave them runningâ€¦\nAfter a day I see howâ€™s my API working, so I browse to (GET) <a href="http://my_pi_address:3000/sensehat">http://my<em>pi</em>address:3000/sensehat</a></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/sensehat-dashboard-api-2-af9d06e257b3e282620a03f5546e3239-4e7fe.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 364px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 32.69230769230769%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3qAD/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAARARMf/aAAgBAQABPyGG6//aAAwDAQACAAMAAAAQgA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAXEAEAAwAAAAAAAAAAAAAAAAABEBFR/9oACAEBAAE/EAEqrJ//2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="sensehat dashboard api 2"\n        title=""\n        src="/static/sensehat-dashboard-api-2-af9d06e257b3e282620a03f5546e3239-4e7fe.jpg"\n        srcset="/static/sensehat-dashboard-api-2-af9d06e257b3e282620a03f5546e3239-c2920.jpg 148w,\n/static/sensehat-dashboard-api-2-af9d06e257b3e282620a03f5546e3239-58d58.jpg 295w,\n/static/sensehat-dashboard-api-2-af9d06e257b3e282620a03f5546e3239-4e7fe.jpg 364w"\n        sizes="(max-width: 364px) 100vw, 364px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>then, <a href="http://my_pi_address:3000/sensehat/temperature">http://my<em>pi</em>address:3000/sensehat/temperature</a></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/sensehat-dashboard-api-3-c0a6bc29a176e90e962bf36e1ab2c441-7efb3.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 460px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 32.608695652173914%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd2wSD//xAAVEAEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAQABBQKP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAEDH/2gAIAQEABj8Cr//EABUQAQEAAAAAAAAAAAAAAAAAABAR/9oACAEBAAE/IaX/2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAQUBAAAAAAAAAAAAAAAAEQABECExYf/aAAgBAQABPxDu1MRex//Z\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="sensehat dashboard api 3"\n        title=""\n        src="/static/sensehat-dashboard-api-3-c0a6bc29a176e90e962bf36e1ab2c441-7efb3.jpg"\n        srcset="/static/sensehat-dashboard-api-3-c0a6bc29a176e90e962bf36e1ab2c441-d1cf1.jpg 148w,\n/static/sensehat-dashboard-api-3-c0a6bc29a176e90e962bf36e1ab2c441-144b3.jpg 295w,\n/static/sensehat-dashboard-api-3-c0a6bc29a176e90e962bf36e1ab2c441-7efb3.jpg 460w"\n        sizes="(max-width: 460px) 100vw, 460px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>and <a href="http://my_pi_address:3000/sensehat/temperature/historic">http://my<em>pi</em>address:3000/sensehat/temperature/historic</a></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/sensehat-dashboard-api-4-92fad9c7ec0b614a5647099b35d7f941-e8189.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 317px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 214.51104100946372%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAArABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB92WGwc5uJsLmMJ2C/wD/xAAbEAACAwADAAAAAAAAAAAAAAAAARARIQIxQf/aAAgBAQABBQJmwzYfeiGVDKjken//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAWEAADAAAAAAAAAAAAAAAAAAAgMDH/2gAIAQEABj8CbR//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhMRD/2gAIAQEAAT8hteQbaeWvIb3wriBacQWwV9PALCjx50QYOT//2gAMAwEAAgADAAAAEFvBzF8P/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxBf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8Qgwn/xAAcEAEBAQACAwEAAAAAAAAAAAABEQAhMUFRYXH/2gAIAQEAAT8QRA+JzxuSSfJhpuFaHmaFCnqmOt2TPMZh08nquqbxnJPH3Bqn7iznvEFQnvBUR+mOud2vjmBHKhd//9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="sensehat dashboard api 4"\n        title=""\n        src="/static/sensehat-dashboard-api-4-92fad9c7ec0b614a5647099b35d7f941-e8189.jpg"\n        srcset="/static/sensehat-dashboard-api-4-92fad9c7ec0b614a5647099b35d7f941-206bd.jpg 148w,\n/static/sensehat-dashboard-api-4-92fad9c7ec0b614a5647099b35d7f941-bc030.jpg 295w,\n/static/sensehat-dashboard-api-4-92fad9c7ec0b614a5647099b35d7f941-e8189.jpg 317w"\n        sizes="(max-width: 317px) 100vw, 317px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>which contains 300 objects.</p>\n<p>That is great, it works like a charm but still it doesnâ€™t look like a good dashboard.</p>\n<p>In future I\'d build a compelling dashboard using React ðŸ™‚</p>',frontmatter:{date:"October 16, 2016",path:"/sensehat-dashboard-2",title:"building a simple dashboard for SenseHat using Python, Mongodb, Nodejs and Angularjs (part 2 â€“ post to API)"}}},pathContext:{}}}});
//# sourceMappingURL=path---sensehat-dashboard-2-60b4f1e108135ec80940.js.map